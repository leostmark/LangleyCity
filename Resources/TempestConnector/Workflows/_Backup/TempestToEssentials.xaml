<Activity mc:Ignorable="sads sap" x:Class="{x:Null}" sap:VirtualizedContainerService.HintSize="1762,5577" mva:VisualBasic.Settings="Assembly references and imported namespaces serialized as XML namespaces"
 xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities"
 xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
 xmlns:eacg="clr-namespace:ESRI.ArcGIS.Client.Geometry;assembly=ESRI.ArcGIS.Client"
 xmlns:eact="clr-namespace:ESRI.ArcGIS.Client.Tasks;assembly=ESRI.ArcGIS.Client"
 xmlns:esri="http://schemas.esri.com/arcgis/client/2009"
 xmlns:ggg="clr-namespace:Geocortex.Gis.Geometries;assembly=Geocortex.Gis"
 xmlns:gpctwa="clr-namespace:Geocortex.Projects.CoLG.Tempest.Workflows.Activities;assembly=Geocortex.Projects.CoLG.Tempest.Workflows"
 xmlns:gpctwd="clr-namespace:Geocortex.Projects.CoLG.Tempest.Workflows.Data;assembly=Geocortex.Projects.CoLG.Tempest.Workflows"
 xmlns:gswad="clr-namespace:Geocortex.Services.Workflow.Activities.DatabaseActivities;assembly=Geocortex.Services.Workflow.DatabaseActivities"
 xmlns:gwa="clr-namespace:Geocortex.Workflow.Activities;assembly=Geocortex.Workflow.Activities"
 xmlns:gwa1="clr-namespace:Geocortex.Workflow.Activities;assembly=Geocortex.Workflow"
 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
 xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities"
 xmlns:s="clr-namespace:System;assembly=System"
 xmlns:s1="clr-namespace:System;assembly=mscorlib"
 xmlns:s2="clr-namespace:System;assembly=System.Core"
 xmlns:s3="clr-namespace:System;assembly=System.ServiceModel"
 xmlns:s4="clr-namespace:System;assembly=System.Numerics"
 xmlns:s5="clr-namespace:System;assembly=System.Web.Services"
 xmlns:s6="clr-namespace:System;assembly=System.AddIn"
 xmlns:s7="clr-namespace:System;assembly=System.Design"
 xmlns:s8="clr-namespace:System;assembly=System.Drawing.Design"
 xmlns:s9="clr-namespace:System;assembly=System.ComponentModel.Composition"
 xmlns:sa="clr-namespace:System.Activities;assembly=System.Activities"
 xmlns:sads="http://schemas.microsoft.com/netfx/2010/xaml/activities/debugger"
 xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation"
 xmlns:scg="clr-namespace:System.Collections.Generic;assembly=System.Core"
 xmlns:scg1="clr-namespace:System.Collections.Generic;assembly=System"
 xmlns:scg2="clr-namespace:System.Collections.Generic;assembly=mscorlib"
 xmlns:scg3="clr-namespace:System.Collections.Generic;assembly=System.ServiceModel"
 xmlns:scs="clr-namespace:System.Collections.Specialized;assembly=System"
 xmlns:sd="clr-namespace:System.Data;assembly=System.Data"
 xmlns:si="clr-namespace:System.IO;assembly=WindowsBase"
 xmlns:si1="clr-namespace:System.IO;assembly=mscorlib"
 xmlns:si2="clr-namespace:System.IO;assembly=System"
 xmlns:si3="clr-namespace:System.IO;assembly=System.Core"
 xmlns:si4="clr-namespace:System.IO;assembly=System.ServiceModel"
 xmlns:sl="clr-namespace:System.Linq;assembly=System.Core"
 xmlns:st="clr-namespace:System.Text;assembly=mscorlib"
 xmlns:sw="clr-namespace:System.Web;assembly=System.Web"
 xmlns:sw1="clr-namespace:System.Web;assembly=System"
 xmlns:sxs="clr-namespace:System.Xml.Serialization;assembly=System.Xml"
 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <Sequence sap:VirtualizedContainerService.HintSize="1722,5497" mva:VisualBasic.Settings="Assembly references and imported namespaces serialized as XML namespaces">
    <Sequence.Variables>
      <Variable x:TypeArguments="x:String" Name="tempestSessionId" />
      <Variable x:TypeArguments="scg2:Dictionary(x:String, scg2:List(x:String))" Name="tempestResults" />
      <Variable x:TypeArguments="scg2:Dictionary(x:String, x:String)" Default="[New Dictionary (Of String, String)]" Name="tempestMappings" />
      <Variable x:TypeArguments="gpctwd:TempestSession" Name="tempestSession" />
      <Variable x:TypeArguments="x:String" Name="initializationErrorMessage" />
      <Variable x:TypeArguments="esri:Envelope" Name="zoomEnvelope" />
      <Variable x:TypeArguments="s1:DateTime" Name="lastUpdateTime" />
      <Variable x:TypeArguments="x:Boolean" Name="isFirstLoad" />
      <Variable x:TypeArguments="x:Boolean" Default="False" Name="exitWorkflow" />
      <Variable x:TypeArguments="x:String" Default="C:\temp\tempest_{0}_timestamp.txt" Name="timeStampFile" />
      <Variable x:TypeArguments="x:Boolean" Name="isRefreshTimeExceeded" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg2:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
      </scg2:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <gpctwa:TempestStartActivity DisplayName="Get Tempest Session ID" ExternalId="TempestStartActivity" sap:VirtualizedContainerService.HintSize="1700,22" TempestSessionID="[tempestSessionId]" />
    <If Condition="[String.IsNullOrEmpty(tempestSessionId)]" sap:VirtualizedContainerService.HintSize="1700,5311">
      <If.Then>
        <gwa:ServerPlaceHolder Description="If no Tempest session id, then the map has been launched independent of Tempest and nothing needs to be done." sap:VirtualizedContainerService.HintSize="314,83" />
      </If.Then>
      <If.Else>
        <Sequence sap:VirtualizedContainerService.HintSize="1361,5163">
          <Sequence.Variables>
            <Variable x:TypeArguments="x:String" Default="Tempest" Name="MapServiceId" />
            <Variable x:TypeArguments="x:String" Default="OBJECTID" Name="LinkFieldName" />
          </Sequence.Variables>
          <sap:WorkflowViewStateService.ViewState>
            <scg2:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            </scg2:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Sequence sap:VirtualizedContainerService.HintSize="1339,1674">
            <Sequence.Variables>
              <Variable x:TypeArguments="sd:DataTable" Name="dataTable1" />
              <Variable x:TypeArguments="x:String" Name="lastTime" />
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg2:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <gwa:DynamicExternal DisplayName="Check if this is first load this session" ExternalId="IsFirstLoad" sap:VirtualizedContainerService.HintSize="1187,175">
              <gwa:DynamicExternal.OutArguments>
                <gwa1:ArgumentWrapper x:TypeArguments="OutArgument" IsRequired="False" Name="isFirstLoad">
                  <gwa1:ArgumentWrapper.Argument>
                    <OutArgument x:TypeArguments="x:Boolean">[isFirstLoad]</OutArgument>
                  </gwa1:ArgumentWrapper.Argument>
                </gwa1:ArgumentWrapper>
              </gwa:DynamicExternal.OutArguments>
            </gwa:DynamicExternal>
            <gswad:ExecuteSqlQuery CommandType="[System.Data.CommandType.Text]" ConnectionConfigurationName="TempestConnectionString" sap:VirtualizedContainerService.HintSize="1187,161" ProviderName="System.Data.SqlClient" Results="[dataTable1]" SqlCommandText="[string.Format(&quot;SELECT W.DATE_STAMP FROM WC_SESSION_DETAILS W, LAND_LEGAL L WHERE W.SESSION_ID = '{0}' AND W.LEGAL_ID = L.LEGAL_ID AND W.GIS_LAYER_NAME = 'Property'&quot;,tempestSessionId)]">
              <sap:WorkflowViewStateService.ViewState>
                <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg2:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </gswad:ExecuteSqlQuery>
            <If Condition="[dataTable1 IsNot Nothing AndAlso dataTable1.Rows.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="1187,1240">
              <sap:WorkflowViewStateService.ViewState>
                <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg2:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <If.Then>
                <Sequence sap:VirtualizedContainerService.HintSize="1062,1092">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg2:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <If Condition="[isFirstLoad]" sap:VirtualizedContainerService.HintSize="1040,968">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg2:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <If.Then>
                      <Sequence sap:VirtualizedContainerService.HintSize="504,400">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg2:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <gwa:Log sap:VirtualizedContainerService.HintSize="482,61" Message="This is the first execution for this session so saving DATE_STAMP as last time executed" />
                        <gwa:DynamicExternal ExternalId="SetLastUpdateTime" sap:VirtualizedContainerService.HintSize="482,175">
                          <gwa:DynamicExternal.InArguments>
                            <gwa1:ArgumentWrapper x:TypeArguments="InArgument" IsRequired="False" Name="lastUpdateTime">
                              <gwa1:ArgumentWrapper.Argument>
                                <InArgument x:TypeArguments="s1:DateTime">[CType(dataTable1.Rows(0)(0), DateTime)]</InArgument>
                              </gwa1:ArgumentWrapper.Argument>
                            </gwa1:ArgumentWrapper>
                          </gwa:DynamicExternal.InArguments>
                        </gwa:DynamicExternal>
                      </Sequence>
                    </If.Then>
                    <If.Else>
                      <Sequence sap:VirtualizedContainerService.HintSize="511,820">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="s1:DateTime" Name="now" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg2:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <gwa:Log sap:VirtualizedContainerService.HintSize="489,61" Message="Calling CheckIfRefreshTimeExceeded" />
                        <gwa:DynamicExternal ExternalId="CheckIfRefreshTimeExceeded" sap:VirtualizedContainerService.HintSize="489,223">
                          <gwa:DynamicExternal.InArguments>
                            <gwa1:ArgumentWrapper x:TypeArguments="InArgument" IsRequired="False" Name="timeToCheck">
                              <gwa1:ArgumentWrapper.Argument>
                                <InArgument x:TypeArguments="s1:DateTime">[CType(dataTable1.Rows(0)(0), DateTime)]</InArgument>
                              </gwa1:ArgumentWrapper.Argument>
                            </gwa1:ArgumentWrapper>
                            <gwa1:ArgumentWrapper x:TypeArguments="InArgument" IsRequired="False" Name="minimumInterval">
                              <gwa1:ArgumentWrapper.Argument>
                                <InArgument x:TypeArguments="x:Int32">10</InArgument>
                              </gwa1:ArgumentWrapper.Argument>
                            </gwa1:ArgumentWrapper>
                          </gwa:DynamicExternal.InArguments>
                          <gwa:DynamicExternal.OutArguments>
                            <gwa1:ArgumentWrapper x:TypeArguments="OutArgument" IsRequired="False" Name="isRefreshTimeExceeded">
                              <gwa1:ArgumentWrapper.Argument>
                                <OutArgument x:TypeArguments="x:Boolean">[isRefreshTimeExceeded]</OutArgument>
                              </gwa1:ArgumentWrapper.Argument>
                            </gwa1:ArgumentWrapper>
                          </gwa:DynamicExternal.OutArguments>
                        </gwa:DynamicExternal>
                        <If Condition="[isRefreshTimeExceeded]" sap:VirtualizedContainerService.HintSize="489,332">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg2:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <If.Then>
                            <Sequence sap:VirtualizedContainerService.HintSize="264,184">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg2:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign sap:VirtualizedContainerService.HintSize="242,60">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:Boolean">[exitWorkflow]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Sequence>
                          </If.Then>
                          <If.Else>
                            <Sequence sap:VirtualizedContainerService.HintSize="200,99">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg2:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </Sequence>
                          </If.Else>
                        </If>
                      </Sequence>
                    </If.Else>
                  </If>
                </Sequence>
              </If.Then>
            </If>
          </Sequence>
          <If Condition="[exitWorkflow = True]" sap:VirtualizedContainerService.HintSize="1339,3325">
            <If.Then>
              <Sequence sap:VirtualizedContainerService.HintSize="200,99">
                <sap:WorkflowViewStateService.ViewState>
                  <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg2:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </Sequence>
            </If.Then>
            <If.Else>
              <Sequence sap:VirtualizedContainerService.HintSize="1114,3177">
                <Sequence.Variables>
                  <Variable x:TypeArguments="scg2:IDictionary(x:String, esri:FeatureSet)" Name="featureSets" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg2:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <gpctwa:CreateTempestSessionActivity ErrorMessage="{x:Null}" SiteName="{x:Null}" DatabaseConnectionStringName="TempestConnectionString" DbExportFields="" DbZoomFields="" DeleteSessionDetailsSql="DELETE FROM WC_SESSION_DETAILS WHERE SESSION_ID = {0}SessionId AND GIS_LAYER_NAME = {1}GIS_LAYER_NAME" DisplayName="Create Tempest Session" GisExportFields="" GisZoomFields="Property=PARCEL_ID" sap:VirtualizedContainerService.HintSize="1092,22" InsertSessionDetailsSql="INSERT INTO WC_SESSION_DETAILS (SESSION_DETAIL_ID, SESSION_ID, SEARCH_LAYER_ID, LEGAL_ID, GISLINK, GIS_LAYER_ID, GIS_LAYER_NAME, DATE_STAMP, USER_STAMP) SELECT {1}, '{2}', WC_SEARCH_LAYERS.SEARCH_LAYER_ID, LAND_LEGAL.LEGAL_ID, LAND_LEGAL.GISLINK, LAND_LEGAL.GIS_LAYER_ID, WC_GIS_LAYERS.GIS_LAYER_NAME, {3}, 'ESSENTIALS' FROM LAND_LEGAL, WC_GIS_LAYERS, WC_SEARCH_LAYERS WHERE LAND_LEGAL.{4} = {0}UniqueId AND WC_GIS_LAYERS.GIS_LAYER_NAME = {0}LayerName AND WC_GIS_LAYERS.SEARCH_LAYER_ID = WC_SEARCH_LAYERS.SEARCH_LAYER_ID" LayerNameMappings="PROPERTY=Property" ProviderName="System.Data.SqlClient" SelectMapLayersSql="SELECT DISTINCT (GIS_LAYER_NAME) FROM WC_GIS_LAYERS" SelectSessionDetailsSql="SELECT L.{1} FROM WC_SESSION_DETAILS W, LAND_LEGAL L WHERE W.SESSION_ID = {0}SessionId AND W.LEGAL_ID = L.LEGAL_ID AND W.GIS_LAYER_NAME = {0}LayerName" TempestSession="[tempestSession]" TempestSessionId="[tempestSessionId]" ZoomBuffer="0" />
                <Flowchart DisplayName="Collect Tempest Mapping Variables" sap:VirtualizedContainerService.HintSize="1092,51">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                      <av:Size x:Key="ShapeSize">60,75</av:Size>
                      <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,107.5 305,107.5 305,122.5</av:PointCollection>
                      <x:Double x:Key="Width">627.83109982808446</x:Double>
                      <x:Double x:Key="Height">811.17000000000007</x:Double>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg2:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Flowchart.StartNode>
                    <FlowDecision x:Name="__ReferenceID4" Condition="[tempestSession.GisZoomFields IsNot Nothing]" sap:VirtualizedContainerService.HintSize="70,87">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                          <av:Point x:Key="ShapeLocation">270,122.5</av:Point>
                          <av:Size x:Key="ShapeSize">70,87</av:Size>
                          <av:PointCollection x:Key="TrueConnector">270,166 240,166 240,160 200,160</av:PointCollection>
                          <av:PointCollection x:Key="FalseConnector">340,166 352.5,166 352.5,232.5 322.5,232.5 322.5,262.5</av:PointCollection>
                        </scg2:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <FlowDecision.True>
                        <FlowStep x:Name="__ReferenceID5">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:Point x:Key="ShapeLocation">0,149</av:Point>
                              <av:Size x:Key="ShapeSize">200,22</av:Size>
                              <av:PointCollection x:Key="ConnectorLocation">100,171 100,232.5 287.5,232.5 287.5,262.5</av:PointCollection>
                            </scg2:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <AddToCollection x:TypeArguments="scg2:KeyValuePair(x:String, x:String)" Collection="[tempestMappings]" DisplayName="GisZoomFields" sap:VirtualizedContainerService.HintSize="200,22" Item="[New KeyValuePair(Of String, String)(&quot;GisZoomFields&quot;, tempestSession.GisZoomFields.ToString)]" />
                          <FlowStep.Next>
                            <FlowDecision x:Name="__ReferenceID3" Condition="[tempestSession.DbZoomFields IsNot Nothing]" sap:VirtualizedContainerService.HintSize="70,87">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                  <av:Point x:Key="ShapeLocation">270,262.5</av:Point>
                                  <av:Size x:Key="ShapeSize">70,87</av:Size>
                                  <av:PointCollection x:Key="TrueConnector">270,306 240,306 240,300 200,300</av:PointCollection>
                                  <av:PointCollection x:Key="FalseConnector">340,306 352.5,306 352.5,372.5 322.5,372.5 322.5,402.5</av:PointCollection>
                                </scg2:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <FlowDecision.True>
                                <FlowStep x:Name="__ReferenceID6">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:Point x:Key="ShapeLocation">0,289</av:Point>
                                      <av:Size x:Key="ShapeSize">200,22</av:Size>
                                      <av:PointCollection x:Key="ConnectorLocation">100,311 100,372.5 287.5,372.5 287.5,402.5</av:PointCollection>
                                    </scg2:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <AddToCollection x:TypeArguments="scg2:KeyValuePair(x:String, x:String)" Collection="[tempestMappings]" DisplayName="DbZoomFields" sap:VirtualizedContainerService.HintSize="200,22" Item="[New KeyValuePair(Of String, String)(&quot;DbZoomFields&quot;, tempestSession.DbZoomFields.ToString)]" />
                                  <FlowStep.Next>
                                    <FlowDecision x:Name="__ReferenceID2" Condition="[tempestSession.GisExportFields IsNot Nothing]" sap:VirtualizedContainerService.HintSize="70,87">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">270,402.5</av:Point>
                                          <av:Size x:Key="ShapeSize">70,87</av:Size>
                                          <av:PointCollection x:Key="TrueConnector">270,446 240,446 240,440 210,440</av:PointCollection>
                                          <av:PointCollection x:Key="FalseConnector">340,446 352.5,446 352.5,502.5 322.5,502.5 322.5,532.5</av:PointCollection>
                                        </scg2:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <FlowDecision.True>
                                        <FlowStep x:Name="__ReferenceID7">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                              <av:Point x:Key="ShapeLocation">10,429</av:Point>
                                              <av:Size x:Key="ShapeSize">200,22</av:Size>
                                              <av:PointCollection x:Key="ConnectorLocation">110,451 110,502.5 287.5,502.5 287.5,532.5</av:PointCollection>
                                            </scg2:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <AddToCollection x:TypeArguments="scg2:KeyValuePair(x:String, x:String)" Collection="[tempestMappings]" DisplayName="GisExportFields" sap:VirtualizedContainerService.HintSize="200,22" Item="[New KeyValuePair(Of String, String)(&quot;GisExportFields&quot;, tempestSession.GisExportFields.ToString)]" />
                                          <FlowStep.Next>
                                            <FlowDecision x:Name="__ReferenceID1" Condition="[tempestSession.DbExportFields IsNot Nothing]" sap:VirtualizedContainerService.HintSize="70,87">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">270,532.5</av:Point>
                                                  <av:Size x:Key="ShapeSize">70,87</av:Size>
                                                  <av:PointCollection x:Key="TrueConnector">270,576 240,576 240,570 200,570</av:PointCollection>
                                                  <av:PointCollection x:Key="FalseConnector">340,576 352.5,576 352.5,622.5 322.5,622.5 322.5,652.5</av:PointCollection>
                                                </scg2:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <FlowDecision.True>
                                                <FlowStep x:Name="__ReferenceID8">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">0,559</av:Point>
                                                      <av:Size x:Key="ShapeSize">200,22</av:Size>
                                                      <av:PointCollection x:Key="ConnectorLocation">100,581 100,622.5 287.5,622.5 287.5,652.5</av:PointCollection>
                                                    </scg2:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <AddToCollection x:TypeArguments="scg2:KeyValuePair(x:String, x:String)" Collection="[tempestMappings]" DisplayName="DbExportFields" sap:VirtualizedContainerService.HintSize="200,22" Item="[New KeyValuePair(Of String, String)(&quot;DbExportFields&quot;, tempestSession.DbExportFields.ToString)]" />
                                                  <FlowStep.Next>
                                                    <FlowDecision x:Name="__ReferenceID0" Condition="[tempestSession.LayerNameMappings IsNot Nothing]" sap:VirtualizedContainerService.HintSize="70,87">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">270,652.5</av:Point>
                                                          <av:Size x:Key="ShapeSize">70,87</av:Size>
                                                          <av:PointCollection x:Key="TrueConnector">270,696 240,696 240,690 200,690</av:PointCollection>
                                                        </scg2:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <FlowDecision.True>
                                                        <FlowStep x:Name="__ReferenceID9">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">0,679</av:Point>
                                                              <av:Size x:Key="ShapeSize">200,22</av:Size>
                                                              <av:PointCollection x:Key="ConnectorLocation">110,591 110,637.446666666667 295,637.446666666667 295,662.5</av:PointCollection>
                                                            </scg2:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <AddToCollection x:TypeArguments="scg2:KeyValuePair(x:String, x:String)" Collection="[tempestMappings]" DisplayName="LayerNameMappings" sap:VirtualizedContainerService.HintSize="200,22" Item="[New KeyValuePair(Of String, String)(&quot;LayerNameMappings&quot;, System.Web.HttpUtility.UrlEncode(tempestSession.LayerNameMappings.ToString))]" />
                                                        </FlowStep>
                                                      </FlowDecision.True>
                                                    </FlowDecision>
                                                  </FlowStep.Next>
                                                </FlowStep>
                                              </FlowDecision.True>
                                              <FlowDecision.False>
                                                <x:Reference>__ReferenceID0</x:Reference>
                                              </FlowDecision.False>
                                            </FlowDecision>
                                          </FlowStep.Next>
                                        </FlowStep>
                                      </FlowDecision.True>
                                      <FlowDecision.False>
                                        <x:Reference>__ReferenceID1</x:Reference>
                                      </FlowDecision.False>
                                    </FlowDecision>
                                  </FlowStep.Next>
                                </FlowStep>
                              </FlowDecision.True>
                              <FlowDecision.False>
                                <x:Reference>__ReferenceID2</x:Reference>
                              </FlowDecision.False>
                            </FlowDecision>
                          </FlowStep.Next>
                        </FlowStep>
                      </FlowDecision.True>
                      <FlowDecision.False>
                        <x:Reference>__ReferenceID3</x:Reference>
                      </FlowDecision.False>
                    </FlowDecision>
                  </Flowchart.StartNode>
                  <x:Reference>__ReferenceID4</x:Reference>
                  <x:Reference>__ReferenceID5</x:Reference>
                  <x:Reference>__ReferenceID3</x:Reference>
                  <x:Reference>__ReferenceID6</x:Reference>
                  <x:Reference>__ReferenceID2</x:Reference>
                  <x:Reference>__ReferenceID7</x:Reference>
                  <x:Reference>__ReferenceID1</x:Reference>
                  <x:Reference>__ReferenceID8</x:Reference>
                  <x:Reference>__ReferenceID0</x:Reference>
                  <x:Reference>__ReferenceID9</x:Reference>
                </Flowchart>
                <gpctwa:RetrieveTempestMappingsActivity DisplayName="Send Tempest Configuration" ExternalId="RetrieveTempestMappings" sap:VirtualizedContainerService.HintSize="1092,22" TempestMappings="[tempestMappings]" />
                <InvokeMethod sap:VirtualizedContainerService.HintSize="1092,128" MethodName="Initialize">
                  <InvokeMethod.TargetObject>
                    <InArgument x:TypeArguments="gpctwd:TempestSession">[tempestSession]</InArgument>
                  </InvokeMethod.TargetObject>
                </InvokeMethod>
                <InvokeMethod sap:VirtualizedContainerService.HintSize="1092,128" MethodName="GetTempestSelection">
                  <InvokeMethod.Result>
                    <OutArgument x:TypeArguments="scg2:Dictionary(x:String, scg2:List(x:String))">[tempestResults]</OutArgument>
                  </InvokeMethod.Result>
                  <InvokeMethod.TargetObject>
                    <InArgument x:TypeArguments="gpctwd:TempestSession">[tempestSession]</InArgument>
                  </InvokeMethod.TargetObject>
                </InvokeMethod>
                <gwa:CreateDictionary x:TypeArguments="x:String, esri:FeatureSet" sap:VirtualizedContainerService.HintSize="1092,86" Result="[featureSets]" />
                <ForEach x:TypeArguments="scg2:KeyValuePair(x:String, scg2:List(x:String))" DisplayName="ForEach&lt;KeyValuePair&lt;String,List&lt;String&gt;&gt;&gt;" sap:VirtualizedContainerService.HintSize="1092,950" Values="[tempestResults]">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg2:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ActivityAction x:TypeArguments="scg2:KeyValuePair(x:String, scg2:List(x:String))">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="scg2:KeyValuePair(x:String, scg2:List(x:String))" Name="layer" />
                    </ActivityAction.Argument>
                    <If Condition="[layer.Value.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="1062,802">
                      <If.Then>
                        <Flowchart DisplayName="Query for Features" sap:VirtualizedContainerService.HintSize="826,654">
                          <Flowchart.Variables>
                            <Variable x:TypeArguments="st:StringBuilder" Default="[New StringBuilder]" Name="queryValues" />
                            <Variable x:TypeArguments="esri:FeatureSet" Name="featureSet" />
                            <Variable x:TypeArguments="x:String" Name="layerId" />
                            <Variable x:TypeArguments="x:String" Name="mapserviceUrl" />
                            <Variable x:TypeArguments="esri:Envelope" Name="featuresEnvelope" />
                          </Flowchart.Variables>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                              <av:Size x:Key="ShapeSize">60,75</av:Size>
                              <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,134.5</av:PointCollection>
                              <x:Double x:Key="Width">812.33109982808446</x:Double>
                              <x:Double x:Key="Height">617.5</x:Double>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg2:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Flowchart.StartNode>
                            <FlowStep x:Name="__ReferenceID10">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                  <av:Point x:Key="ShapeLocation">200,134.5</av:Point>
                                  <av:Size x:Key="ShapeSize">200,51</av:Size>
                                  <av:PointCollection x:Key="ConnectorLocation">400,160 520,160</av:PointCollection>
                                </scg2:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ForEach x:TypeArguments="x:String" DisplayName="Create IN clause values" sap:VirtualizedContainerService.HintSize="200,51" Values="[layer.Value]">
                                <ActivityAction x:TypeArguments="x:String">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="x:String" Name="item" />
                                  </ActivityAction.Argument>
                                  <InvokeMethod sap:VirtualizedContainerService.HintSize="257,130" MethodName="Append">
                                    <InvokeMethod.TargetObject>
                                      <InArgument x:TypeArguments="st:StringBuilder">[queryValues]</InArgument>
                                    </InvokeMethod.TargetObject>
                                    <InArgument x:TypeArguments="x:String">[item + ","]</InArgument>
                                  </InvokeMethod>
                                </ActivityAction>
                              </ForEach>
                              <FlowStep.Next>
                                <FlowStep x:Name="__ReferenceID13">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:Point x:Key="ShapeLocation">520,134.5</av:Point>
                                      <av:Size x:Key="ShapeSize">200,51</av:Size>
                                      <av:PointCollection x:Key="ConnectorLocation">620,185.5 620,235.5</av:PointCollection>
                                    </scg2:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <gwa:GetMapServiceInfo sap:VirtualizedContainerService.HintSize="200,51" LayerId="[layerId]" LayerName="[layer.Key]" MapServiceId="[MapServiceId]" MapServiceUrl="[mapserviceUrl]" />
                                  <FlowStep.Next>
                                    <FlowStep x:Name="__ReferenceID18">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">520,235.5</av:Point>
                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                          <av:PointCollection x:Key="ConnectorLocation">520,261 490,261 490,231 400,231</av:PointCollection>
                                        </scg2:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <gwa:Log sap:VirtualizedContainerService.HintSize="200,51" Message="[string.Format(&quot;Layer name = {0}; layer id = {1}&quot;, layer.Key, layerId)]">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg2:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </gwa:Log>
                                      <FlowStep.Next>
                                        <FlowStep x:Name="__ReferenceID14">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                              <av:Point x:Key="ShapeLocation">200,205.5</av:Point>
                                              <av:Size x:Key="ShapeSize">200,51</av:Size>
                                              <av:PointCollection x:Key="ConnectorLocation">300,256.5 300,286.5 305,286.5 305,302.5</av:PointCollection>
                                            </scg2:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <TryCatch sap:VirtualizedContainerService.HintSize="200,51">
                                            <TryCatch.Try>
                                              <Sequence sap:VirtualizedContainerService.HintSize="359,569">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg2:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <gwa:Log sap:VirtualizedContainerService.HintSize="337,61" Message="[mapserviceUrl + &quot;/&quot; + layerId + &quot;/query&quot;]" />
                                                <gwa:Log sap:VirtualizedContainerService.HintSize="337,61" Message="[LinkFieldName + &quot; IN (&quot; + queryValues.ToString.Trim(New Char(){&quot;,&quot;c}) + &quot;)&quot;]" />
                                                <gwa:QueryTask sap:VirtualizedContainerService.HintSize="337,243" OutFields="*" QueryServiceUrl="[mapserviceUrl + &quot;/&quot; + layerId + &quot;/query&quot;]" Results="[featureSet]" ReturnGeometry="True" SpatialRelationship="esriSpatialRelIntersects" Where="[LinkFieldName + &quot; IN (&quot; + queryValues.ToString.Trim(New Char(){&quot;,&quot;c}) + &quot;)&quot;]" />
                                              </Sequence>
                                            </TryCatch.Try>
                                            <TryCatch.Catches>
                                              <Catch x:TypeArguments="s1:Exception" sap:VirtualizedContainerService.HintSize="404,21">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg2:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ActivityAction x:TypeArguments="s1:Exception">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="s1:Exception" Name="exception" />
                                                  </ActivityAction.Argument>
                                                  <Sequence DisplayName="Retry query with OBJECTID in case mapping is wrong" sap:VirtualizedContainerService.HintSize="359,640">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg2:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ForEach x:TypeArguments="x:String" DisplayName="Create IN clause values" sap:VirtualizedContainerService.HintSize="337,276" Values="[layer.Value]">
                                                      <ActivityAction x:TypeArguments="x:String">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="x:String" Name="item" />
                                                        </ActivityAction.Argument>
                                                        <InvokeMethod sap:VirtualizedContainerService.HintSize="218,128" MethodName="Append">
                                                          <InvokeMethod.TargetObject>
                                                            <InArgument x:TypeArguments="st:StringBuilder">[queryValues]</InArgument>
                                                          </InvokeMethod.TargetObject>
                                                          <InArgument x:TypeArguments="x:String">["'" + item + "',"]</InArgument>
                                                        </InvokeMethod>
                                                      </ActivityAction>
                                                    </ForEach>
                                                    <gwa:QueryTask sap:VirtualizedContainerService.HintSize="337,243" OutFields="*" QueryServiceUrl="[mapserviceUrl + &quot;/&quot; + layerId + &quot;/query&quot;]" Results="[featureSet]" ReturnGeometry="True" SpatialRelationship="esriSpatialRelIntersects" Where="[&quot;OBJECTID IN (&quot; + queryValues.ToString.Trim(New Char(){&quot;,&quot;c}) + &quot;)&quot;]" />
                                                  </Sequence>
                                                </ActivityAction>
                                              </Catch>
                                            </TryCatch.Catches>
                                          </TryCatch>
                                          <FlowStep.Next>
                                            <FlowDecision x:Name="__ReferenceID11" Condition="[featureSet IsNot Nothing]" sap:VirtualizedContainerService.HintSize="70,87">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">270,302.5</av:Point>
                                                  <av:Size x:Key="ShapeSize">70,87</av:Size>
                                                  <av:PointCollection x:Key="FalseConnector">340,346 370,346 370,340 420,340</av:PointCollection>
                                                  <av:PointCollection x:Key="TrueConnector">270,346 240,346 240,341 210,341</av:PointCollection>
                                                </scg2:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <FlowDecision.True>
                                                <FlowStep x:Name="__ReferenceID16">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">10,315.5</av:Point>
                                                      <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                      <av:PointCollection x:Key="ConnectorLocation">110,366.5 110,385.5</av:PointCollection>
                                                    </scg2:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <gwa:AddToDictionary x:TypeArguments="x:String, esri:FeatureSet" Dictionary="[featureSets]" sap:VirtualizedContainerService.HintSize="200,51" Key="[layerId]" Value="[featureSet]" />
                                                  <FlowStep.Next>
                                                    <FlowStep x:Name="__ReferenceID17">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">10,385.5</av:Point>
                                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                          <av:PointCollection x:Key="ConnectorLocation">110,436.5 110,465.5</av:PointCollection>
                                                        </scg2:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <gwa:GetFeatureSetExtent FeatureSet="[featureSet]" sap:VirtualizedContainerService.HintSize="200,51" Result="[featuresEnvelope]" />
                                                      <FlowStep.Next>
                                                        <FlowStep x:Name="__ReferenceID15">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">10,465.5</av:Point>
                                                              <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                            </scg2:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If Condition="[zoomEnvelope Is Nothing]" DisplayName="Assign Zoom Envelope" sap:VirtualizedContainerService.HintSize="200,51">
                                                            <If.Then>
                                                              <Sequence sap:VirtualizedContainerService.HintSize="264,280">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg2:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <gwa:Log sap:VirtualizedContainerService.HintSize="242,59" LogLevel="Debug" Message="assigning featuresEnvelope to zoomEnvelope" />
                                                                <Assign sap:VirtualizedContainerService.HintSize="242,57">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="esri:Envelope">[zoomEnvelope]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="esri:Envelope">[featuresEnvelope]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </Sequence>
                                                            </If.Then>
                                                            <If.Else>
                                                              <Sequence sap:VirtualizedContainerService.HintSize="264,280">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg2:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <gwa:Log sap:VirtualizedContainerService.HintSize="242,59" LogLevel="Debug" Message="merging featuresEnvelope with zoomEnvelope" />
                                                                <Assign sap:VirtualizedContainerService.HintSize="242,57">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="esri:Envelope">[zoomEnvelope]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="esri:Envelope">[zoomEnvelope.Extent.Union(featuresEnvelope.Extent)]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </Sequence>
                                                            </If.Else>
                                                          </If>
                                                        </FlowStep>
                                                      </FlowStep.Next>
                                                    </FlowStep>
                                                  </FlowStep.Next>
                                                </FlowStep>
                                              </FlowDecision.True>
                                              <FlowDecision.False>
                                                <FlowStep x:Name="__ReferenceID12">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">420,314.5</av:Point>
                                                      <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                    </scg2:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <gwa:Log sap:VirtualizedContainerService.HintSize="200,51" LogLevel="Debug" Message="No features returned from query" />
                                                </FlowStep>
                                              </FlowDecision.False>
                                            </FlowDecision>
                                          </FlowStep.Next>
                                        </FlowStep>
                                      </FlowStep.Next>
                                    </FlowStep>
                                  </FlowStep.Next>
                                </FlowStep>
                              </FlowStep.Next>
                            </FlowStep>
                          </Flowchart.StartNode>
                          <x:Reference>__ReferenceID10</x:Reference>
                          <x:Reference>__ReferenceID11</x:Reference>
                          <x:Reference>__ReferenceID12</x:Reference>
                          <x:Reference>__ReferenceID13</x:Reference>
                          <x:Reference>__ReferenceID14</x:Reference>
                          <x:Reference>__ReferenceID15</x:Reference>
                          <x:Reference>__ReferenceID16</x:Reference>
                          <x:Reference>__ReferenceID17</x:Reference>
                          <x:Reference>__ReferenceID18</x:Reference>
                        </Flowchart>
                      </If.Then>
                      <If.Else>
                        <WriteLine sap:VirtualizedContainerService.HintSize="211,61" Text="No results" />
                      </If.Else>
                    </If>
                  </ActivityAction>
                </ForEach>
                <gwa:CommentOut sap:VirtualizedContainerService.HintSize="1092,51">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg2:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <gwa:DynamicExternal ExternalId="ClearDefaultCollection" sap:VirtualizedContainerService.HintSize="208,151" />
                </gwa:CommentOut>
                <gwa:RunExternalCommand CommandName="ClearSelection" sap:VirtualizedContainerService.HintSize="1092,86" />
                <If Condition="[featureSets.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="1092,1169">
                  <If.Then>
                    <Sequence sap:VirtualizedContainerService.HintSize="504,1021">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg2:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ForEach x:TypeArguments="scg2:KeyValuePair(x:String, esri:FeatureSet)" DisplayName="ForEach&lt;KeyValuePair&lt;String,FeatureSet&gt;&gt;" sap:VirtualizedContainerService.HintSize="482,433" Values="[featureSets]">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg2:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ActivityAction x:TypeArguments="scg2:KeyValuePair(x:String, esri:FeatureSet)">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="scg2:KeyValuePair(x:String, esri:FeatureSet)" Name="item" />
                          </ActivityAction.Argument>
                          <Sequence sap:VirtualizedContainerService.HintSize="335,285">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg2:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <gwa:SelectFeatures ClearCollectionFirst="False" FeatureSet="[item.Value]" sap:VirtualizedContainerService.HintSize="313,161" LayerId="[item.Key]" MapServiceId="[MapServiceId]" />
                          </Sequence>
                        </ActivityAction>
                      </ForEach>
                      <If Condition="[zoomEnvelope IsNot Nothing]" sap:VirtualizedContainerService.HintSize="482,209">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg2:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <If.Then>
                          <gwa:SetMapExtent Extent="[zoomEnvelope.Extent.Expand(1.1)]" sap:VirtualizedContainerService.HintSize="221,61" />
                        </If.Then>
                        <If.Else>
                          <gwa:Log sap:VirtualizedContainerService.HintSize="235,61" LogLevel="Debug" Message="No features received from Tempest; map will not be zoomed." />
                        </If.Else>
                      </If>
                      <gwa:DynamicExternal ExternalId="TempestSelectionsCompleted" sap:VirtualizedContainerService.HintSize="482,175">
                        <gwa:DynamicExternal.InArguments>
                          <gwa1:ArgumentWrapper x:TypeArguments="InArgument" IsRequired="False" Name="AllLayers">
                            <gwa1:ArgumentWrapper.Argument>
                              <InArgument x:TypeArguments="scg2:List(x:String)">[tempestSession.AllTempestLayerNames]</InArgument>
                            </gwa1:ArgumentWrapper.Argument>
                          </gwa1:ArgumentWrapper>
                        </gwa:DynamicExternal.InArguments>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg2:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg2:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </gwa:DynamicExternal>
                    </Sequence>
                  </If.Then>
                </If>
              </Sequence>
            </If.Else>
          </If>
        </Sequence>
      </If.Else>
    </If>
  </Sequence>
</Activity>